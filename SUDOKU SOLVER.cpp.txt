#include <bits/stdc++.h>
using namespace std;

class Solution {
public:
    bool flag = false;

    void solver(vector<vector<char>>& ans, vector<vector<char>>& board,
                vector<vector<int>>& row, vector<vector<int>>& col,
                vector<vector<int>>& grid, vector<vector<int>>& box, int i, int j) {

        if (j == 9) {
            j = 0;
            i = i + 1;
            if (i == 9) {
                if (flag == false) {
                    ans = board;
                    flag = true;
                }
                return;
            }
        }

        if (board[i][j] != '.') {
            solver(ans, board, row, col, grid, box, i, j + 1);
            return;
        } 
        else {
            int x = grid[i / 3][j / 3];

            for (int m = 0; m < 9; m++) {
                if (row[i][m] == 0 && col[j][m] == 0 && box[x][m] == 0) {

                    row[i][m] = 1;
                    col[j][m] = 1;
                    box[x][m] = 1;
                    board[i][j] = '1' + m;

                    solver(ans, board, row, col, grid, box, i, j + 1);

                    row[i][m] = 0;
                    col[j][m] = 0;
                    box[x][m] = 0;
                    board[i][j] = '.';
                }
            }
        }
    }

    void solveSudoku(vector<vector<char>>& board) {
        vector<vector<char>> ans(9, vector<char>(9, '.'));
        vector<vector<int>> row(9, vector<int>(9, 0));
        vector<vector<int>> col(9, vector<int>(9, 0));
        vector<vector<int>> grid(3, vector<int>(3, 0));

        int x = 0;
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 3; j++) {
                grid[i][j] = x;
                x++;
            }
        }

        vector<vector<int>> box(9, vector<int>(9, 0));

        for (int i = 0; i < 9; i++) {
            for (int j = 0; j < 9; j++) {
                char c = board[i][j];
                if (c == '.') continue;

                row[i][c - '1']++;
                col[j][c - '1']++;
                box[grid[i / 3][j / 3]][c - '1']++;
            }
        }

        solver(ans, board, row, col, grid, box, 0, 0);
        board = ans;
    }
};

int main() {
    vector<vector<char>> board(9, vector<char>(9));

    cout << "Enter Sudoku (use . for empty cells):\n";

    for (int i = 0; i < 9; i++) {
        for (int j = 0; j < 9; j++) {
            cin >> board[i][j];
        }
    }

    Solution obj;
    obj.solveSudoku(board);

    cout << "\nSolved Sudoku:\n";

    for (int i = 0; i < 9; i++) {
        for (int j = 0; j < 9; j++) {
            cout << board[i][j] << " ";
        }
        cout << endl;
    }
}
